<!doctype html>
<html lang="en">
<head>
  <title>swar a tiny JS reactive library</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" href="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22%3E%3Ctext%20y=%22.9em%22%20font-size=%2290%22%3Eüö≤%3C/text%3E%3C/svg%3E">
  <link rel="stylesheet" href="https://cdn.pragmore.com/2.0.0/balloon/blouse.css?font=Inconsolata&family=monospace&size=16pt" crossorigin="anonymous">
</head>
<body>
  <nav>
    <input type="checkbox" id="menu-toggle" aria-hidden="true" />
    <a href="#" data-var="properties">üö≤ {{ name }}</a>
    <label for="menu-toggle" aria-hidden="true"></label>
    <ul>
        <li><a href="#quick-start">Show variable</a></li>
        <li><a href="#clock">Clock</a></li>
        <li><a href="#todo-list">TODO List</a></li>
        <li><a href="#fetch-if">Fetch and if</a></li>
    </ul>
  </nav>
  <main>

    <div data-var="properties">
      <h1 class="text-center">{{ title }}</h1>
      <p class="text-center">{{ description }}</p>
    </div>

    <p class="text-center text-lg">
      <a class="btn main" href="#" data-onclick="alert('Sorry, this is a work in progress, read this source code for how to use it')">Documentation</a>
      <a class="btn alt" href="https://github.com/pragmore/swar/archive/refs/heads/main.zip">Download</a>
    </p>
    
    <h2>Features</h2>
    <ul>
      <li data-for="features">{{ $element }} ‚úÖ</li>
    </ul>
    
    <h2 id="clock" class="mt-2">Clock</h2>
    <p data-var="time">
      Time now is <strong>{{ $var }}</strong> hs
    </p>

    <h2 id="todo-list" class="mt-2">TODO list</h2>
    <form data-onsubmit="if (this.todo.value) { $todo.push(this.todo.value); this.todo.value='' }">
      <p><input name="todo" id="title" placeholder="New task" aria-label="New task" /></p>
      <p><button class="main">Create</button></p>
    </form>
    <ul>
      <li data-for="todo">
        {{ $element }} <a href="#" title="Remove from list {{ $element }}" class="btn alt" data-onclick="$todo.splice($index, 1)">‚ùå</a>
      </li>
    </ul>

    <h2 id="fetch-if" class="mt-2">Fetch and if</h2>
    <p data-if="!externalTodos">Loading table...</p>
    <table data-if="externalTodos && externalTodos.length > 0">
      <tr>
        <th>ID</th>
        <th>Title</th>
        <th>Completed</th>
      </tr>
      <tr data-for="externalTodos">
        <td>{{ $index % 2 ? 'even' : 'odd' }} <strong>{{ $element.id }}</strong></td>
        <td>{{ $element.title }}</td>
        <td>{{ $element.completed }}</td>
      </tr>
    </table>

  </main>
  <footer>
    <span>Made with ‚ù§Ô∏è</span>
    <span><a href="https://github.com/pragmore/swar/blob/main/LICENSE" target="_blank">MIT Licence</a></span>
    <span>
      <a href="https://github.com/pragmore/swar" target="_blank" aria-label="GitHub">
        <i class="gh" aria-hidden="true" title="GitHub"></i>
      </a>
    </span>
    <span>
      by <a href="https://pragmore.com">Pragmore</a>
    </span>
  </footer>
<script src="swar.js"></script>
<script>
/* Render variables */
$properties({
  "name": "swar",
  "title": "Write less with <em>swar</em>",
  "description": "A tiny JavaScript reactive library",
  "features": [
    "Simple: add the script, the data-* attributes and set the variables",
    "Light, minimal footprint",
    "Use modern JavaScript and HMTL features",
  ]
})
$features($properties().features)

/* Initialize todo var */
$todo(["First task", "Second and final task"])

/* Update clock every second */
const updateTime = () => {
  const zero = digit => digit < 10 ? '0' + digit: digit 
  const date = new Date()
  $time(date.getHours() + ':' + zero(date.getMinutes()) + ':' + zero(date.getSeconds()))
}
updateTime()
setInterval(updateTime, 1000)

/* External fetch */
$externalTodos.fetch('https://jsonplaceholder.typicode.com/todos/?userId=1').then(console.log)

/* This is for the menu, don't copy this code! */
document.querySelectorAll('nav a').forEach(el => el.onclick = (() => (document.getElementById('menu-toggle').checked = false) || true))
</script>
</body>
</html>
